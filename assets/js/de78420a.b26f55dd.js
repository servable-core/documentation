"use strict";(self.webpackChunkservable=self.webpackChunkservable||[]).push([[750],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>f});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),s=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},m=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,c=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),p=s(n),h=r,f=p["".concat(c,".").concat(h)]||p[h]||d[h]||l;return n?o.createElement(f,a(a({ref:t},m),{},{components:n})):o.createElement(f,a({ref:t},m))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,a=new Array(l);a[0]=h;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[p]="string"==typeof e?e:r,a[1]=i;for(var s=2;s<l;s++)a[s]=n[s];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},46772:(e,t,n)=>{n.d(t,{Z:()=>H});var o,r,l,a,i,c,s,m,p,d,h,f,u,v,k,y,b,E,F,g,x,w,S,M,j,z,O,A,N,C,T,P,q,G,D=n(67294);function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Z.apply(this,arguments)}const H=e=>{let{title:t,titleId:n,...H}=e;return D.createElement("svg",Z({xmlns:"http://www.w3.org/2000/svg",width:384,height:261,viewBox:"-0.5 -0.5 384 261","aria-labelledby":n},H),t?D.createElement("title",{id:n},t):null,o||(o=D.createElement("path",{d:"M239 125q81 0 81-51",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),r||(r=D.createElement("circle",{cx:320,cy:70,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:4})),l||(l=D.createElement("path",{d:"M239 125q101 0 101 30",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),a||(a=D.createElement("circle",{cx:340,cy:160,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),i||(i=D.createElement("path",{d:"M199.5 150q0 35 35.25 35T270 215",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),c||(c=D.createElement("circle",{cx:270,cy:220,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),s||(s=D.createElement("path",{d:"M160 125q-90 0-90 70",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),m||(m=D.createElement("circle",{cx:70,cy:200,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),p||(p=D.createElement("path",{d:"M160 125H75",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),d||(d=D.createElement("circle",{cx:70,cy:125,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),h||(h=D.createElement("path",{d:"M160 125q-70 0-70-70",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),f||(f=D.createElement("circle",{cx:90,cy:50,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),u||(u=D.createElement("path",{d:"M199.5 100V35",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),v||(v=D.createElement("circle",{cx:199.5,cy:30,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),k||(k=D.createElement("path",{d:"M199.5 150q0 35-24.75 35T150 215",fill:"none",stroke:"#F0F0F0",strokeMiterlimit:10,pointerEvents:"stroke"})),y||(y=D.createElement("circle",{cx:150,cy:220,fill:"#F0F0F0",stroke:"#F0F0F0",pointerEvents:"all",r:5})),b||(b=D.createElement("path",{d:"m165 112.5 2.5-6.25Q170 100 180 100h39q10 0 13.72 9.29l3.14 7.85q3.14 7.86-.57 17.15l-3.14 7.85Q229 150 219 150h-39q-10 0-13.71-9.28l-3.15-7.86q-3.14-7.86-.64-14.11Z",fill:"none",stroke:"#F0F0F0",strokeWidth:2,strokeMiterlimit:10,pointerEvents:"all"})),E||(E=D.createElement("text",{x:199,y:130.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:14},"Protocol")),F||(F=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M290 40h60v30h-60z"})),g||(g=D.createElement("text",{x:319.5,y:59.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Routes")),x||(x=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M120 220h60v30h-60z"})),w||(w=D.createElement("text",{x:149.5,y:239.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Jobs")),S||(S=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M0 110h70v30H0z"})),M||(M=D.createElement("text",{x:34.5,y:129.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Services")),j||(j=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M40 200h60v30H40z"})),z||(z=D.createElement("text",{x:69.5,y:219.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Schema")),O||(O=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M60 20h60v30H60z"})),A||(A=D.createElement("text",{x:89.5,y:39.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Config")),N||(N=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M169.5 0h60v30h-60z"})),C||(C=D.createElement("text",{x:199,y:19.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Seed")),T||(T=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M240 220h60v40h-60z"})),P||(P=D.createElement("text",{x:269.5,y:237.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Triggers")),q||(q=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M300 160h80v40h-80z"})),G||(G=D.createElement("text",{x:339.5,y:177.5,fill:"#F0F0F0",fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Design System")))}},17490:(e,t,n)=>{n.d(t,{Z:()=>H});var o,r,l,a,i,c,s,m,p,d,h,f,u,v,k,y,b,E,F,g,x,w,S,M,j,z,O,A,N,C,T,P,q,G,D=n(67294);function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Z.apply(this,arguments)}const H=e=>{let{title:t,titleId:n,...H}=e;return D.createElement("svg",Z({xmlns:"http://www.w3.org/2000/svg",width:385,height:262,viewBox:"-0.5 -0.5 385 262","aria-labelledby":n},H),t?D.createElement("title",{id:n},t):null,o||(o=D.createElement("path",{d:"M239 125q81 0 81-51",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),r||(r=D.createElement("circle",{cx:320,cy:70,stroke:"#000",pointerEvents:"all",r:4})),l||(l=D.createElement("path",{d:"M239 125q101 0 101 30",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),a||(a=D.createElement("circle",{cx:340,cy:160,stroke:"#000",pointerEvents:"all",r:5})),i||(i=D.createElement("path",{d:"M199.5 150q0 35 35.25 35T270 215",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),c||(c=D.createElement("circle",{cx:270,cy:220,stroke:"#000",pointerEvents:"all",r:5})),s||(s=D.createElement("path",{d:"M160 125q-90 0-90 70",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),m||(m=D.createElement("circle",{cx:70,cy:200,stroke:"#000",pointerEvents:"all",r:5})),p||(p=D.createElement("path",{d:"M160 125H75",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),d||(d=D.createElement("circle",{cx:70,cy:125,stroke:"#000",pointerEvents:"all",r:5})),h||(h=D.createElement("path",{d:"M160 125q-70 0-70-70",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),f||(f=D.createElement("circle",{cx:90,cy:50,stroke:"#000",pointerEvents:"all",r:5})),u||(u=D.createElement("path",{d:"M199.5 100V35",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),v||(v=D.createElement("circle",{cx:199.5,cy:30,stroke:"#000",pointerEvents:"all",r:5})),k||(k=D.createElement("path",{d:"M199.5 150q0 35-24.75 35T150 215",fill:"none",stroke:"#000",strokeMiterlimit:10,pointerEvents:"stroke"})),y||(y=D.createElement("circle",{cx:150,cy:220,stroke:"#000",pointerEvents:"all",r:5})),b||(b=D.createElement("path",{d:"m165 112.5 2.5-6.25Q170 100 180 100h39q10 0 13.72 9.29l3.14 7.85q3.14 7.86-.57 17.15l-3.14 7.85Q229 150 219 150h-39q-10 0-13.71-9.28l-3.15-7.86q-3.14-7.86-.64-14.11Z",fill:"none",stroke:"#000",strokeWidth:2,strokeMiterlimit:10,pointerEvents:"all"})),E||(E=D.createElement("text",{x:199,y:130.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:14},"Protocol")),F||(F=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M290 40h60v30h-60z"})),g||(g=D.createElement("text",{x:319.5,y:59.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Routes")),x||(x=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M120 220h60v30h-60z"})),w||(w=D.createElement("text",{x:149.5,y:239.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Jobs")),S||(S=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M0 110h70v30H0z"})),M||(M=D.createElement("text",{x:34.5,y:129.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Services")),j||(j=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M40 200h60v30H40z"})),z||(z=D.createElement("text",{x:69.5,y:219.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Schema")),O||(O=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M60 20h60v30H60z"})),A||(A=D.createElement("text",{x:89.5,y:39.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Config")),N||(N=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M169.5 0h60v30h-60z"})),C||(C=D.createElement("text",{x:199,y:19.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Seed")),T||(T=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M240 220h60v40h-60z"})),P||(P=D.createElement("text",{x:269.5,y:237.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Triggers")),q||(q=D.createElement("path",{fill:"none",pointerEvents:"all",d:"M300 160h80v40h-80z"})),G||(G=D.createElement("text",{x:339.5,y:177.5,fontFamily:"Space Grotesk",textAnchor:"middle",fontSize:12},"Design System")))}},9771:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(64593),r=n(67294);const l=e=>{const{id:t,size:n="s",mode:l="default"}=e;return r.createElement("div",{className:""},r.createElement("div",{id:t,"data-id":t,"data-size":n,"data-mode":l,class:"servable-protocol-widget"},r.createElement("div",{className:"bg-slate-200  rounded-xl  px-4  py-4  pt-14  min-h-44  min-w-sm "},r.createElement("h4",{className:""},"Protocol",r.createElement("br",null),`${t}`,r.createElement("br",null),"..."))),r.createElement(o.q,null,r.createElement("link",{href:"https://cdn.servable.app/widgets/protocol/index.css",rel:"stylesheet"}),r.createElement("script",{async:!0,src:"https://cdn.servable.app/widgets/protocol/index.js"})))}},76669:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(67294),r=n(9200);const l=e=>{let{light:t,dark:n,className:l="",role:a="img"}=e;const{colorMode:i}=(0,r.I)(),c="dark"===i?n:t;return o.createElement(c,{className:` \n            ${l}         \n          w-full`,role:a})}},68622:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>c,default:()=>f,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var o=n(87462),r=(n(67294),n(3905)),l=n(9771),a=n(76669);const i={sidebar_position:3},c="What is a protocol?",s={unversionedId:"concepts/protocols",id:"concepts/protocols",title:"What is a protocol?",description:"An object oriented programming perspective",source:"@site/docs/concepts/protocols.mdx",sourceDirName:"concepts",slug:"/concepts/protocols",permalink:"/docs/next/concepts/protocols",draft:!1,editUrl:"https://github.com/servable-community/generator-servable/tree/main/packages/create-docusaurus/templates/shared/docs/concepts/protocols.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Terms, definitions and components",permalink:"/docs/next/concepts/components"},next:{title:"Anatomy of a Servable service",permalink:"/docs/next/concepts/anatomy"}},m={},p=[{value:"A better way to group repeatable logic on a database object",id:"a-better-way-to-group-repeatable-logic-on-a-database-object",level:2}],d={toc:p},h="wrapper";function f(e){let{components:t,...i}=e;return(0,r.kt)(h,(0,o.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"what-is-a-protocol"},"What is a protocol?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"An object oriented programming perspective"))," ",(0,r.kt)("br",null),"\nIn many object oriented programming language a protocol describes what an unknown type of object can do. The same way a Servable protocol describes what an unknown database object can do. "),(0,r.kt)("p",null,"A protocol always applies to a class, which is the Servable representation of a database table."),(0,r.kt)("p",null,"By applying a protocol to a class we make it conform to the the protocol's schema, meaning the class' schema will be updated to include the extra fields the protocol needs to work. Even more, the protocol listens to all the events (triggers) sent to the class (beforeSave, afterSave, beforeDelete, afterDelete, ...) so that the class' behavior conforms to the protocol's behavior. The protocol does not cancel the class' own desired behavior, it gets executed in a chain alongside all the class' protocols triggers."),(0,r.kt)("p",null,"A class can have multiple protocols.\nEvery class can customize the way it uses a protocol to an extent (protocol parameters).\nThe same way a protocol can be applied to multiple models."),(0,r.kt)("p",null,"A protocol has no knowledge of the class it's being applied to. It simply manipulates it according to the declared fields and parameters."),(0,r.kt)(a.Z,{name:"orchestration",light:n(17490).Z,dark:n(46772).Z,mdxType:"SVGPlus"}),(0,r.kt)("h2",{id:"a-better-way-to-group-repeatable-logic-on-a-database-object"},"A better way to group repeatable logic on a database object"),(0,r.kt)("p",null,'Let\'s say you have an e-commerce application that enables user comments on a blog page and on a product page. You would probably create a table in your database that holds the comments, with a foreign key to the user who made the comment. For performance reasons you would keep the comments count on the object that is being commented, alongside a reference to a "relevant" comment. You would add those fields to both the blog page table and the product page. Every change you would make the comments system design would have to be manually updated to those two tables.'),(0,r.kt)("p",null,"We can do much better by creating a protocol called ",(0,r.kt)("em",{parentName:"p"},"commentable")," that will be responsible for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Defining the schema and creating the tables needed for the comment protocol, ie CommentableEntry"),(0,r.kt)("li",{parentName:"ul"},"Adding the proper fields to every object that is ",(0,r.kt)("em",{parentName:"li"},"commentable"),", we call them projected field, in this case they are named CommentableRelevantEntry, CommentableCount"),(0,r.kt)("li",{parentName:"ul"},"The security and ACL for the CommentableEntry table and the fields "),(0,r.kt)("li",{parentName:"ul"},"For defining object level logic to its own object models"),(0,r.kt)("li",{parentName:"ul"},"For reacting to object events, for example beforeSave, afterSave, beforeDelete, afterDelete and make sure the object is at all time coherent with the protocol rules")),(0,r.kt)("p",null,"By doing so we have packaged the ability to comment into one component that can be reused easily across the project."),(0,r.kt)("p",null,"A protocol does not stop at the server. Some protocols have a client counterpart that acts in tandem with the server. If we consider the Commentable protocol, it can be distributed in a commentable-server npm package, alongside a commentable-react package that contains React components that can be called on any object that conforms to the protocol. The components include, for a commentable object:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CommentableList")," that displays a paginated list of comments "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CommentableComment")," that displays a paginated list of comments"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CommentableCommentsCount")," that displays the total number of comments "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CommentableCommentsExcerpt")," that displays an excerpt")),(0,r.kt)("p",null,"By making an object Commentable, you're adding not only database fields and server methods to it, you are also taking advantage of a front library made for its capacity."),(0,r.kt)("div",{className:""},(0,r.kt)(l.Z,{id:"@servable-community/framable",mdxType:"ProtocolWidget"})),(0,r.kt)("div",{className:"mt-10"},(0,r.kt)(l.Z,{id:"@servable-community/framable",size:"m",mdxType:"ProtocolWidget"})))}f.isMDXComponent=!0}}]);